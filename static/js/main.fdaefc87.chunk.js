(this.webpackJsonpunderrated=this.webpackJsonpunderrated||[]).push([[0],{59:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},90:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),i=n(21),s=n.n(i),c=n(19),o=(n(59),n(9)),l=n(10),u=n(13),h=n(12),d=n(48),j=(n(60),n(61),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).determineError=function(){if(e.props.error)return Object(r.jsx)("section",{children:Object(r.jsx)("p",{children:e.props.error})})},e.submitLogin=function(){e.props.validateLogin(e.state.email,e.state.password),e.clearInputs()},e.clearInputs=function(){e.setState({email:"",password:""})},e.state={email:"",password:""},e}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault()}},{key:"handleChange",value:function(e){this.props.clearError(),this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("section",{children:[Object(r.jsx)("input",{name:"email",type:"text",placeholder:"Email",value:this.state.email,onClick:function(t){return e.handleClick(t)},onChange:function(t){return e.handleChange(t)}}),Object(r.jsx)("input",{name:"password",type:"password",placeholder:"Password",value:this.state.password,onClick:function(t){return e.handleClick(t)},onChange:function(t){return e.handleChange(t)}}),this.determineError(),Object(r.jsx)("button",{className:"submit-button",onClick:this.submitLogin,children:"SUBMIT"})]})}}]),n}(a.Component)),b=(n(62),function(e){var t=e.id,n=e.title,a=e.rating,i=e.image;return Object(r.jsx)(c.b,{to:"/movie/".concat(t),children:Object(r.jsxs)("section",{className:"poster",id:t,children:[Object(r.jsx)("img",{className:"card-img",src:i,alt:n}),Object(r.jsx)("p",{className:"poster-title",children:n}),Object(r.jsxs)("p",{className:"poster-rating",children:["\u2606 ",a.toFixed(1),"/10"]}),Object(r.jsxs)("p",{className:"poster-rating-mini",children:["\u2606 ",a.toFixed(1),"/10"]})]})})}),m=(n(68),function(e){var t=e.movies,n=e.getSingleMovie,a=t.map((function(e){return Object(r.jsx)(b,{id:e.id,title:e.title,rating:e.average_rating,image:e.poster_path,getSingleMovie:n},e.id)}));return Object(r.jsx)("section",{className:"movie-grid",children:a})}),p="https://rancid-tomatillos.herokuapp.com/api/v2",g=function(e){return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies/".concat(+e)).then((function(e){if(!e.ok)throw Error("Sorry! We've encountered an error");return e.json()}))},f=function(e){return fetch("".concat(p,"/movies/").concat(+e,"/videos")).then((function(e){return e.json()}))},v=(n(69),function(e){var t=e.label,n=e.body;return Object(r.jsxs)("section",{className:"details-box",children:[Object(r.jsx)("p",{className:"l-details",children:Object(r.jsx)("b",{children:t})}),Object(r.jsx)("p",{className:"r-details",children:"$0"===n?"-":n})]})}),O=n(50),x=n(51),w=n.n(x),y=(n(89),n(90),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).determineAvailableTrailers=function(){return e.state.trailers.find((function(e){return"YouTube"===e.site}))},e.formatTrailers=function(){return e.state.trailers.map((function(e){if("YouTube"===e.site)return Object(r.jsx)(w.a,{url:"https://www.youtube.com/watch?v=".concat(e.key)},e.id)}))},e.state={trailers:[],error:""},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;f(this.props.id).then((function(t){return e.setState({trailers:t.videos})})).catch((function(t){return e.setState({error:t.message})}))}},{key:"render",value:function(){return Object(r.jsxs)("section",{className:"trailers",children:[this.determineAvailableTrailers()&&Object(r.jsx)(O.Carousel,{showThumbs:!1,children:this.formatTrailers()}),!this.determineAvailableTrailers()&&Object(r.jsx)("p",{children:"Sorry, no available trailers for this movie."})]})}}]),n}(a.Component)),k=n(52),C=n.n(k),N=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).handleStarChange=function(t){e.setState({rating:t}),e.props.setStarRating(t)},e.state={rating:0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setState({rating:this.props.currentUserRating})}},{key:"componentDidUpdate",value:function(e){this.props.currentUserRating!==e.currentUserRating&&this.setState({rating:this.props.currentUserRating})}},{key:"handleRatingText",value:function(){return null===this.props.currentUser?Object(r.jsx)("p",{children:"Please log in to rate"}):0===this.props.currentUserRating?Object(r.jsx)("p",{children:"Rate this movie"}):Object(r.jsxs)("p",{children:["Your rating is ",this.state.rating]})}},{key:"render",value:function(){return Object(r.jsxs)("section",{children:[this.handleRatingText(),Object(r.jsx)(C.a,{value:this.state.rating,edit:this.props.canEdit,count:10,onChange:this.handleStarChange,size:24,activeColor:"#ffd700"},Math.random())]})}}]),n}(a.Component),S=(n(93),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).setStarRating=function(t){var n,r;e.props.currentUser&&e.state.currentUserRating?(n=e.state.currentUserRating.id,function(e,t){return fetch("".concat(p,"/users/").concat(+e,"/ratings/").concat(+t),{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((function(e){if(!e.ok)throw Error("Sorry! We couldn't retrieve your rating.");return e.json()}))}(r=e.props.currentUser.id,n).then((function(e){return console.log("delete response",e)})).catch((function(t){return e.setState({error:t.message})})),e.createNewRating(r,t)):e.props.currentUser&&(r=e.props.currentUser.id,e.createNewRating(r,t))},e.createNewRating=function(t,n){var r={movie_id:e.state.singleMovie.id,rating:+n};console.log("newRating obj",r),function(e,t){return fetch("".concat(p,"/users/").concat(e,"/ratings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error;return e.json()}))}(t,r).then((function(){return e.updateUserRating()})).catch((function(t){return e.setState({error:t.message})}))},e.updateUserRating=function(){var t;(t=e.props.currentUser.id,fetch("".concat(p,"/users/").concat(+t,"/ratings")).then((function(e){if(!e.ok)throw Error("Sorry! We couldn't retrieve your rating.");return e.json()}))).then((function(t){console.log("allratings",t);var n=t.ratings.find((function(t){return t.movie_id===e.state.singleMovie.id}));console.log("userRating",n),e.setState({currentUserRating:n})})).catch((function(t){return e.setState({error:t.message})}))},e.formatGenres=function(){return e.state.singleMovie.genres?e.state.singleMovie.genres.length>1?e.state.singleMovie.genres.map((function(e){return Object(r.jsx)("p",{className:"genre",children:e},Math.random())})):Object(r.jsx)("p",{className:"genre",children:e.state.singleMovie.genres[0]}):Object(r.jsx)("p",{className:"unavailable-genres",children:"Unavailable"})},e.toggleWatchlist=function(){!1===e.state.onWatchlist?e.setState({onWatchlist:!0}):e.setState({onWatchlist:!1})},e.state={singleMovie:{},error:"",currentUserRating:null,onWatchlist:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.scrollTo(0,0),g(this.props.id).then((function(t){return e.setState({singleMovie:t.movie})})).then((function(){return e.getUserRatings()})).catch((function(t){return e.setState({error:t.message})}))}},{key:"componentDidUpdate",value:function(e){window.scrollTo(0,0),e.currentUser!==this.props.currentUser&&(this.setState({currentUserRating:null,error:""}),this.getUserRatings())}},{key:"getUserRatings",value:function(){this.setState({formattedRating:this.state.singleMovie.average_rating.toFixed(1)}),this.props.currentUser&&this.updateUserRating()}},{key:"generateListItem",value:function(){return Object(r.jsxs)("section",{children:[Object(r.jsx)(v,{label:"Release Date",body:new Date(this.state.singleMovie.release_date).toLocaleDateString()},Math.random()),Object(r.jsx)(v,{label:"Runtime",body:"".concat(this.state.singleMovie.runtime," mins")},Math.random()),Object(r.jsx)(v,{label:"Budget",body:"$".concat(new Intl.NumberFormat("en-US").format(this.state.singleMovie.budget))},Math.random()),Object(r.jsx)(v,{label:"Revenue",body:"$".concat(new Intl.NumberFormat("en-US").format(this.state.singleMovie.revenue))},Math.random())]})}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("section",{className:"movie-details",children:[Object(r.jsx)("section",{className:"banner-container",children:Object(r.jsx)("img",{src:this.state.singleMovie.backdrop_path,className:"banner-img"})}),Object(r.jsxs)("section",{className:"movie-info",children:[Object(r.jsxs)("section",{className:"movie-aside",children:[Object(r.jsx)("img",{src:this.state.singleMovie.poster_path,className:"poster-img"}),this.generateListItem()]}),Object(r.jsxs)("section",{className:"movie-main",children:[Object(r.jsxs)("section",{className:"backdrop-overlay",children:[Object(r.jsx)("section",{className:"responsive-poster",children:Object(r.jsx)("img",{src:this.state.singleMovie.poster_path,className:"poster-img"})}),Object(r.jsxs)("section",{className:"main-header-details",children:[Object(r.jsx)("h1",{className:"title",children:this.state.singleMovie.title}),Object(r.jsx)("p",{className:"tagline",children:this.state.singleMovie.tagline}),Object(r.jsxs)("p",{className:"rating",children:[Object(r.jsxs)("span",{className:"rating-star",children:["\u2606 ",this.state.formattedRating]}),"/10"]}),Object(r.jsx)("section",{className:"genre-list",children:this.formatGenres()})]})]}),Object(r.jsxs)("section",{className:"overview-box",children:[Object(r.jsxs)("section",{className:"rating-watchlist",children:[Object(r.jsx)(N,{currentUser:this.props.currentUser,currentUserRating:this.state.currentUserRating?this.state.currentUserRating.rating:0,canEdit:!!this.props.currentUser,setStarRating:this.setStarRating}),!0===this.state.onWatchlist&&Object(r.jsx)("button",{className:"on-watchlist-button",onClick:function(){return e.toggleWatchlist()},children:"On Watchlist"}),!1===this.state.onWatchlist&&Object(r.jsx)("button",{className:"add-watchlist-button",onClick:function(){return e.toggleWatchlist()},children:"+ Add to Watchlist"})]}),Object(r.jsx)("section",{className:"responsive-genre-list",children:this.formatGenres()}),Object(r.jsx)("h3",{children:"Synopsis"}),Object(r.jsx)("p",{className:"overview",children:this.state.singleMovie.overview}),Object(r.jsx)("section",{className:"responsive-list",children:this.generateListItem()})]}),Object(r.jsxs)("section",{className:"trailer-box",children:[Object(r.jsx)("h3",{className:"trailer-header",children:"Trailers"}),Object(r.jsx)(y,{id:this.props.id})]})]})]})]})}}]),n}(a.Component)),U=(n(94),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).searchByInput=function(t){t.preventDefault(),e.setState({input:t.target.value.toLowerCase()}),e.props.getUserInput(t.target.value)},e.state={input:""},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(r.jsx)("input",{onChange:this.searchByInput,type:"text",value:this.state.input,placeholder:"\ud83d\udd0d search by movie title",className:"search-bar"})}}]),n}(a.Component)),R=n(53),V=n.n(R),M=(n(95),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).displayTrailer=function(){var t=e.state.trailers.videos.find((function(e){return"YouTube"===e.site}));if(t)return Object(r.jsx)("div",{className:"player-wrapper",children:Object(r.jsx)(V.a,{url:"https://www.youtube.com/watch?v=".concat(t.key),className:"react-player",width:"100%",height:"100%",controls:!1,muted:!0,playing:!0,loop:!0,config:{youtube:{playerVars:{disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}}}},t.id)})},e.state={currentMovie:null,trailers:null,error:""},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;f(337401).then((function(t){return e.setState({trailers:t})})).catch((function(t){return e.setState({error:t.message})}))}},{key:"render",value:function(){return Object(r.jsxs)("section",{children:[!this.state.trailers&&Object(r.jsx)("p",{children:"Loading..."}),this.state.trailers&&this.displayTrailer()]})}}]),n}(a.Component)),D=n(5),T=n(30),E=(n(96),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).componentDidMount=function(){fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies").then((function(e){if(!e.ok)throw Error("Sorry! We've encountered an error");return e.json()})).then((function(t){return e.setState({movies:t.movies})})).then((function(){return e.findMovieGenres()})).catch((function(t){return e.setState({error:t.message})}))},e.findMovieGenres=function(){e.state.movies.map((function(e){g(e.id).then((function(t){return e.genres=t.movie.genres}))}))},e.validateLogin=function(t,n){var r;(r={email:t,password:n},fetch("".concat(p,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){if(!e.ok)throw Error("Username and/or password is incorrect. Please try again.");return e.json()}))).then((function(t){return e.setState({currentUser:t.user})})).catch((function(t){return e.setState({error:t.message})}))},e.clearError=function(){e.setState({error:""})},e.signOut=function(){e.setState({currentUser:null})},e.getUserInput=function(t){e.setState({input:t})},e.handleDropdownValue=function(t){e.setState({dropdownValue:t.target.name})},e.handleRatingValue=function(t){e.setState({ratingValue:t.target.value})},e.clearFilters=function(){e.setState({input:"",dropdownValue:"all",ratingValue:"any"})},e.state={movies:[],error:"",currentUser:null,input:"",dropdownValue:"all",ratingValue:"any"},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsxs)("main",{children:[Object(r.jsxs)("header",{children:[Object(r.jsx)("h1",{className:"page-title",children:"underrated"}),Object(r.jsxs)("nav",{children:[Object(r.jsx)(c.c,{exact:!0,to:"/",className:"nav-labels",children:"all movies"}),Object(r.jsx)("p",{className:"nav-labels",children:"watchlist"}),Object(r.jsxs)(T.a,{className:"nav-labels",title:"account",children:[!this.state.currentUser&&Object(r.jsx)(j,{validateLogin:this.validateLogin,error:this.state.error,clearError:this.clearError}),this.state.currentUser&&Object(r.jsxs)("section",{children:[Object(r.jsxs)("p",{children:["Hello, ",this.state.currentUser.name,"!"]}),Object(r.jsx)("button",{onClick:this.signOut,children:"Sign Out"})]})]})]})]}),Object(r.jsx)(D.a,{exact:!0,path:"/",render:function(){return Object(r.jsxs)("section",{children:[Object(r.jsx)(M,{}),Object(r.jsx)(U,{getUserInput:e.getUserInput}),Object(r.jsxs)("section",{className:"genre-filter",children:[Object(r.jsxs)("p",{className:"dropdown-text",children:["showing ",Object(r.jsx)("span",{className:"active-text",children:e.state.dropdownValue})," movies"]}),Object(r.jsxs)(T.a,{title:"",className:"genre-dropdown",children:[Object(r.jsx)("button",{onClick:function(){return e.setState({dropdownValue:"all"})},children:"all"}),Object(r.jsx)("button",{name:"Action",onClick:function(t){return e.handleDropdownValue(t)},children:"action"}),Object(r.jsx)("button",{name:"Adventure",onClick:function(t){return e.handleDropdownValue(t)},children:"adventure"}),Object(r.jsx)("button",{name:"Animation",onClick:function(t){return e.handleDropdownValue(t)},children:"animation"}),Object(r.jsx)("button",{name:"Comedy",onClick:function(t){return e.handleDropdownValue(t)},children:"comedy"}),Object(r.jsx)("button",{name:"Crime",onClick:function(t){return e.handleDropdownValue(t)},children:"crime"}),Object(r.jsx)("button",{name:"Drama",onClick:function(t){return e.handleDropdownValue(t)},children:"drama"}),Object(r.jsx)("button",{name:"Family",onClick:function(t){return e.handleDropdownValue(t)},children:"family"}),Object(r.jsx)("button",{name:"Fantasy",onClick:function(t){return e.handleDropdownValue(t)},children:"fantasy"}),Object(r.jsx)("button",{name:"History",onClick:function(t){return e.handleDropdownValue(t)},children:"history"}),Object(r.jsx)("button",{name:"Horror",onClick:function(t){return e.handleDropdownValue(t)},children:"horror"}),Object(r.jsx)("button",{name:"Music",onClick:function(t){return e.handleDropdownValue(t)},children:"music"}),Object(r.jsx)("button",{name:"Romance",onClick:function(t){return e.handleDropdownValue(t)},children:"romance"}),Object(r.jsx)("button",{name:"Science fiction",onClick:function(t){return e.handleDropdownValue(t)},children:"science fiction"}),Object(r.jsx)("button",{name:"Thriller",onClick:function(t){return e.handleDropdownValue(t)},children:"thriller"}),Object(r.jsx)("button",{name:"War",onClick:function(t){return e.handleDropdownValue(t)},children:"war"}),Object(r.jsx)("button",{name:"Western",onClick:function(t){return e.handleDropdownValue(t)},children:"western"})]}),Object(r.jsxs)("p",{className:"dropdown-text",children:["with ",Object(r.jsx)("span",{className:"active-text",children:e.state.ratingValue})," rating"]}),Object(r.jsxs)(T.a,{title:"",className:"rating-dropdown",children:[Object(r.jsx)("button",{onClick:function(){return e.setState({ratingValue:"any"})},children:"any"}),Object(r.jsx)("button",{name:"one",value:"1",onClick:function(t){return e.handleRatingValue(t)},children:"one"}),Object(r.jsx)("button",{name:"two",value:"2",onClick:function(t){return e.handleRatingValue(t)},children:"two"}),Object(r.jsx)("button",{name:"three",value:"3",onClick:function(t){return e.handleRatingValue(t)},children:"three"}),Object(r.jsx)("button",{name:"four",value:"4",onClick:function(t){return e.handleRatingValue(t)},children:"four"}),Object(r.jsx)("button",{name:"five",value:"5",onClick:function(t){return e.handleRatingValue(t)},children:"five"}),Object(r.jsx)("button",{name:"six",value:"6",onClick:function(t){return e.handleRatingValue(t)},children:"six"}),Object(r.jsx)("button",{name:"seven",value:"7",onClick:function(t){return e.handleRatingValue(t)},children:"seven"}),Object(r.jsx)("button",{name:"eight",value:"8",onClick:function(t){return e.handleRatingValue(t)},children:"eight"}),Object(r.jsx)("button",{name:"nine",value:"9",onClick:function(t){return e.handleRatingValue(t)},children:"nine"}),Object(r.jsx)("button",{name:"ten",value:"10",onClick:function(t){return e.handleRatingValue(t)},children:"ten"})]}),""!==e.state.input||"all"!==e.state.dropdownValue||"any"!==e.state.ratingValue&&Object(r.jsx)("button",{className:"clear",onClick:function(){return e.clearFilters()},children:"clear"})]}),Object(r.jsx)(m,{movies:e.filterMoviesBySelection})]})}}),Object(r.jsx)(D.a,{exact:!0,path:"/movie/:id",render:function(t){var n=t.match;return Object(r.jsx)(S,{id:n.params.id,currentUser:e.state.currentUser})}})]})}},{key:"filterMoviesBySelection",get:function(){var e=this,t=this.state.movies.filter((function(t){return"all"!==e.state.dropdownValue&&t.genres?t.genres.includes(e.state.dropdownValue):e.state.movies}));return t.filter((function(n){return"any"!==e.state.ratingValue?parseInt(n.average_rating)===parseInt(e.state.ratingValue):t})).filter((function(t){return t.title.toLowerCase().includes(e.state.input)}))}}]),n}(a.Component)),I=Object(r.jsx)(c.a,{children:Object(r.jsx)(E,{})});s.a.render(I,document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.fdaefc87.chunk.js.map